# Задание №13
**Что мы узнаем**:  
Как покрыть код тестами.

**Задача**:
Написать тесты на модуль ```tools.pm```  

**Описание**:  
Чем больше тестов, тем лучше программный код.
Написав одну ф-цию, казалось бы, зачем ее менять, но на практике все обстоит иначе. Функционал расширяется и ф-ция дорабатывается снова и снова. Но где гарантии, что внеся изменения в код, вы не нарушите ее логику, что в итоге приведет к падению системы в целом. По хорошему, чтобы гарантировать, что изменения ничего не поломали, нужно протестировать ф-цию целиком. Но это затратно по времени, а время это ценнейший ресурс, которого всегда не хватает. Вот тут нам на помощь и приходят тесты. Написав тест на ф-цию, вы можете запускать его сколько угодно раз и в результате получите гарантию, что логика не нарушена, если конечно код покрыт тестами полностью. Полное покрытие достигается тогда, когда вы вызываете ф-цию так, чтобы выполнялось каждое условие(```if```, ```elsif```, ```else```), вызывался каждый ```return```. Т.е. если ф-ция проверяет, что при отсутствии файла, возвращается ошибка, то при выполнении теста нужно воспроизвести недоступность файла(например изменив его права или переименовав). Но это в идеальном мире и перебарщивать тоже не стоит.
Тесты начинаются с ```use Test::More tests =>(число тестов);```  

**Вот пример простого теста**:  
```perl
is(create_user($GOOD_USER), $RC_OK, 'create_user(user_name) OK');
is(create_user($WRONG_USER), $RC_ERROR, 'create_user(user_name) wrong name OK');
is(create_user(), $RC_ERROR, 'create_user() without input user_name OK');
```
В примере тестируется ф-ция ```create_user()```. В первом тесте передаются правильные параметры и ф-ция возвращает хороший код. Во втором случае передается заведомо неправильный логин, чтобы проверить, что ф-ция вернула код ошибки. В третьем примере ф-ция вызывается без параметров вовсе тем самым проверяя, что разработчик предвидел подобный вариант и вернул код ошибки.

Покройте подобными тестами модуль ```tools.pm```. Для этого в папке проекта создайте папку tests и в ней файл ```tools.t``` Расширение ```'.t'``` показывает, что это именно тест. Запускайте написанные тесты простым запуском ```perl tools.t``` из командной строки(в больших командах тесты запускаются автоматически при внесении изменений в репозиторий)

**Подсказка**:  
При прохождении тестов, они могут оставлять после себя созданные файлы, менять права и т.д. Сделайте так, чтобы перед выходом скрипт удалял весь созданный мусор и тесты можно было запускать сколько угодно раз.

**Полезные привычки**:  
После написания кода, на его покрытие тестами никогда не хватает времени. Тут нам на помощь приходит технология ***TDD*** (*Test Driven Development*) это когда сначала пишется тест, а потом уже код (Прочитайте про данный подход и попробуйте его применить при написании следующей ф-ции в модуле ```tools.pm```)

**Литература**:  
Perl Изучаем глубже - Глава 17(Основы тестирования)


РЕШЕНИЯ: [Тесты](../tests/tools_12.t)
---
[На главную](../README.md)
